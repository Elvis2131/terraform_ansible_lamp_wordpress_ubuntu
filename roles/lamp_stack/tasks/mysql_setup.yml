- name: Create root user password(Debian).
  mysql_user:
    login_host: 'localhost'
    login_unix_socket: /var/run/mysqld/mysqld.sock
    login_user: 'root'
    login_password: ''
    name: root
    password: "{{ root_password }}"
    state: present
  when: ansible_distribution == "Ubuntu"

- name: mysql_root_password(RedHat)
  mysql_user:
    login_user: root
    login_password: "{{ root_password }}"
    user: root
    check_implicit_admin: yes
    password: "{{ root_password }}"
    host: localhost
  when: ansible_distribution == 'RedHat'

- name: Removing all anonymous users.
  mysql_user:
    name: ''
    host: localhost
    state: absent
    login_user: root
    login_password: "{{ root_password }}"

- name: Creating a super user.
  mysql_user:
    user: &mysql_user elartey
    password: '{{ user_password }}'
    priv: '*.*:ALL'
    state: present
    login_user: 'root'
    login_password: "{{ root_password }}"
  notify: Restart mysql

- name: Creating a database for wordpress.
  mysql_db:
    name: '{{ database_name }}'
    state: present
    login_user: *mysql_user
    login_password: '{{ user_password }}'